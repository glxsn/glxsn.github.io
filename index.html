<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>给力小少年的板块</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./css/main.css" />
    <link
      rel="shortcut icon"
      href="https://img.zmal.top/frined/57de5ad8ef1705f8fc15a83aa4de2706_720.4ub7p2t8cl.jpg"
      type="image/x-icon"
    />
    <link rel="stylesheet" href="./css/search.css" />
    <style>
      .article-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
      }

      .article-item {
        background: var(--card-bg);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        transition: all 0.3s ease;
        border: 1px solid rgba(0, 0, 0, 0.05);
      }

      .article-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      }

      .article-item h3 {
        font-size: 1.3rem;
        margin-bottom: 12px;
        color: var(--primary);
      }

      .article-item .meta {
        color: var(--text-light);
        font-size: 0.85rem;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .article-item .meta i {
        color: var(--primary);
      }

      .article-item .excerpt {
        margin-bottom: 15px;
        color: var(--text);
        line-height: 1.6;
        font-size: 0.95rem;
      }

      .read-more {
        display: inline-block;
        padding: 8px 16px;
        background-color: var(--primary);
        color: white;
        text-decoration: none;
        border-radius: 50px;
        transition: all 0.3s ease;
        font-size: 0.85rem;
      }

      .read-more:hover {
        background-color: #6a8fc1;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(125, 157, 202, 0.3);
      }

      /* 主要内容区 - 增加顶部内边距 */
      .container {
        max-width: 1000px;
        margin: 60px auto 40px;
        /* 增加上边距 */
        padding: 0 30px;
        flex: 1;
      }

      h1 {
        font-size: 2.8rem;
        margin-bottom: 40px;
        font-weight: 300;
        text-align: center;
        color: var(--primary);
        position: relative;
        display: inline-block;
        left: 50%;
        transform: translateX(-50%);
        padding-top: 20px;
      }

      h1::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, var(--primary), var(--highlight));
        border-radius: 3px;
      }

      /* 卡片式内容区块 */
      .card {
        background: var(--card-bg);
        padding: 40px;
        margin-bottom: 30px;
        border-radius: 20px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        border: 1px solid rgba(0, 0, 0, 0.03);
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
      }

      .card h2 {
        font-size: 1.8rem;
        margin-bottom: 20px;
        color: var(--primary);
        position: relative;
        padding-bottom: 10px;
      }

      .card h2::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 50px;
        height: 3px;
        background-color: var(--highlight);
        border-radius: 3px;
      }

      .card p {
        margin-bottom: 20px;
        font-size: 1.1rem;
        color: var(--text-light);
        line-height: 1.8;
      }

      /* 响应式设计 - 手机端优化 */
      @media (max-width: 768px) {
        .card h2 {
          font-size: 1.5rem;
          margin-bottom: 15px;
          line-height: 1.4;
        }

        .card p {
          font-size: 1.05rem;
          margin-bottom: 18px;
          line-height: 1.75;
        }

        .article-list {
          grid-template-columns: 1fr;
        }
      }

      /* 动画效果 */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .article-item {
        animation: fadeIn 0.4s ease forwards;
        opacity: 0;
      }

      /* 新增：优化标题位置 */
      .title-container {
        margin-top: 30px;
        margin-bottom: 20px;
      }

      @media (max-width: 768px) {
        .title-container {
          margin-top: 40px;
          /* 增加移动端上边距 */
          margin-bottom: 15px;
        }
      }
    </style>
  </head>

  <body>
    <header id="mainHeader">
      <nav>
        <ul>
          <li><a href="#" class="active">首页</a></li>
          <li><a href="about.html">关于</a></li>
          <li><a href="dh.html">作品</a></li>
          <li><a href="#">联系</a></li>
        </ul>

        <div class="search-container">
          <div class="search-box">
            <input
              type="text"
              class="search-input"
              placeholder="搜索文章..."
              id="searchInput"
            />
            <button class="search-btn" id="searchBtn">
              <i class="fas fa-search"></i>
            </button>
            <div class="search-results" id="searchResults">
              <div class="search-results-header">
                <h3>搜索结果</h3>
                <button class="close-search" id="closeSearch">
                  <i class="fas fa-times"></i>
                </button>
              </div>
              <div class="article-list" id="resultsContainer">
                <!-- 搜索结果将在这里显示为卡片 -->
              </div>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <div class="container" id="contentContainer">
      <div class="title-container">
        <h1>· 给力小少年的板块！ ·</h1>
      </div>

      <div class="card" id="about-this-page">
        <h2>关于这个界面</h2>
        <p>
          欢迎来到我的个人空间！这里是一个正在不断完善的创意平台，我会在这里分享我的想法、作品和经验。
        </p>
        <p>还会完善哒</p>
      </div>

      <div class="card" id="about-this-section">
        <h2>关于这个板块</h2>
        <p>
          这里主要分享我在游戏Mod开发过程中遇到的各种问题和解决方案，包括但不限于：
        </p>
        <p>• 主流游戏的Mod制作教程</p>
        <p>• 开发过程中遇到的疑难杂症</p>
        <p>• 有趣的创意实现</p>
        <p>• 偶尔也会分享一些其他技术领域的心得</p>
      </div>

      <div class="card" id="latest-updates">
        <h2>最新动态</h2>
        <p>• 优化了手机端的界面表现，并且修复了其的许多bug</p>
        <p>• 现在可以自动定位搜索到的文章啦</p>
        <p>• 完善了搜索功能，现在可以搜索这个板块的文章啦</p>
        <p>• 更新了一下界面</p>
      </div>
    </div>

    <footer>
      <p>头发掉光光啦</p>
    </footer>

    <script>
        // 导航栏选中效果
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', function() {
                document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
                this.classList.add('active');
            });
        });
        
        // 搜索功能实现（动态扫描所有页面内容）
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchBtn = document.getElementById('searchBtn');
            const searchResults = document.getElementById('searchResults');
            const header = document.getElementById('mainHeader');
            const container = document.getElementById('contentContainer');
            
            // 要搜索的页面列表
            const pagesToSearch = ['index.html', 'bi.html', 'dh.html'];
            
            // 从DOM动态获取文章数据
            function getArticlesFromDOM(htmlContent, pageUrl) {
                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlContent, 'text/html');
                
                return Array.from(doc.querySelectorAll('.card')).map((card, index) => ({
                    id: card.id || `card-${index}`,  // 使用已有ID或生成一个
                    title: card.querySelector('h2')?.textContent || '无标题',
                    content: Array.from(card.querySelectorAll('p'))
                               .map(p => p.textContent).join(' '),
                    url: pageUrl,
                    excerpt: Array.from(card.querySelectorAll('p'))
                               .map(p => p.textContent).join(' ').substring(0, 100) + '...'
                }));
            }
            
            // 获取所有页面的文章数据
            async function getAllArticles() {
                let allArticles = [];
                
                // 首先添加当前页面的文章
                const currentPageArticles = getArticlesFromDOM(document.documentElement.outerHTML, window.location.pathname.split('/').pop() || 'index.html');
                allArticles = allArticles.concat(currentPageArticles);
                
                // 获取其他页面的文章
                for (const page of pagesToSearch) {
                    // 跳过当前页面
                    if (page === (window.location.pathname.split('/').pop() || 'index.html')) {
                        continue;
                    }
                    
                    try {
                        const response = await fetch(page);
                        if (!response.ok) continue;
                        
                        const html = await response.text();
                        const articles = getArticlesFromDOM(html, page);
                        allArticles = allArticles.concat(articles);
                    } catch (error) {
                        console.error(`获取页面 ${page} 失败:`, error);
                    }
                }
                
                return allArticles;
            }
            
            // 执行搜索
            async function performSearch() {
                const query = searchInput.value.trim().toLowerCase();
                
                if (!query) {
                    searchResults.style.display = 'none';
                    return;
                }
                
                // 显示加载状态
                searchResults.innerHTML = '<div class="no-results">搜索中...</div>';
                searchResults.style.display = 'block';
                
                // 获取所有文章
                const articles = await getAllArticles();
                
                // 搜索逻辑
                const results = articles.filter(article => {
                    return article.title.toLowerCase().includes(query) || 
                           article.content.toLowerCase().includes(query);
                });
                
                displayResults(results);
            }
            
            // 显示搜索结果
            function displayResults(results) {
                searchResults.innerHTML = '';
                
                if (results.length === 0) {
                    searchResults.innerHTML = '<div class="no-results">没有找到相关文章</div>';
                    searchResults.style.display = 'block';
                    return;
                }
                
                results.forEach(article => {
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';
                    resultItem.innerHTML = `
                        <a href="${article.url}#${article.id}" style="text-decoration: none; color: inherit;">
                            <div class="search-result-title">${highlightText(article.title, searchInput.value)}</div>
                            <div class="search-result-excerpt">${highlightText(article.excerpt, searchInput.value)}</div>
                            <div class="search-result-source">来自: ${article.url}</div>
                        </a>
                    `;
                    searchResults.appendChild(resultItem);
                });
                
                searchResults.style.display = 'block';
            }
            
            // 高亮显示匹配文本
            function highlightText(text, query) {
                if (!query) return text;
                const escapedQuery = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(escapedQuery, 'gi');
                return text.replace(regex, match => `<span style="background-color: #ffeb3b;">${match}</span>`);
            }
            
            // 事件监听
            searchBtn.addEventListener('click', performSearch);
            searchInput.addEventListener('input', function() {
                clearTimeout(this.timer);
                this.timer = setTimeout(performSearch, 500);
            });
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') performSearch();
            });
            
            // 点击页面其他地方关闭搜索结果
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.search-container')) {
                    searchResults.style.display = 'none';
                }
            });
        });
    </script>
  </body>
</html>
